---
created: 2026-02-17
project: file-server
version: v1
previous_version: null
status: ready
---

# ファイルサーバー一覧画面レイアウト改善

## 背景・課題
現在のファイルサーバー一覧画面では、ファイル一覧の下にフォルダ作成フォームとアップロードフォームがある。
ファイル数が多いと、アクションボタンまでスクロールが必要でUXが悪い。

## 目標
- アクション系UI（フォルダ作成、アップロード）をファイル一覧の**上に**配置
- 次フェーズで実装予定の「テキストファイル作成」機能も考慮したレイアウトにする
- テキスト作成機能は今回はボタンのみ配置（実装は別プラン）
- ファイルドラッグアンドドロップ対応を追加

## 実装案：シンプルレイアウト＋全体ドラッグアンドドロップ

### レイアウト構成
```
[FolderIcon] パンくず
┌─────────────────────────────────────────────────────────┐
│ [FileIcon New File (coming soon)]  [FolderIcon New Folder] │  ← アクションボタン群（SVGアイコン使用）
└─────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────┐
│  ファイル一覧（ドラッグ＆ドロップでアップロード可能）      │  ← 常時ドロップゾーン
│                                                         │
│  [FolderIcon] folder1/                                  │
│  [FolderIcon] folder2/                                  │
│  [FileIcon] file1.txt                                   │
│  [FileIcon] file2.png                                   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 変更対象ファイル
- `/workspaces/monorepo/projects/file-server/src/components/FileList.tsx`

### 実装詳細

#### 1. アクションボタン群の追加（パンくずの下、ファイル一覧の上）
```tsx
<div className="flex gap-3 mb-4">
  <button className="..." disabled>
    <FileIcon /> New File
  </button>
  <button className="..." hx-on:click="...">
    <FolderIcon /> New Folder
  </button>
</div>
```

#### 2. New Folder アコーディオン
- New Folderボタンをクリック → フォルダ作成フォームが展開
- もう一度クリック → フォームが閉じる

#### 3. ドラッグアンドドロップ対応（ファイル一覧全体）
- ファイル一覧エリア全体を常時ドロップ可能に
- ドラッグオーバー時のビジュアルフィードバック（背景色変更など）
- ドロップ時に htmx.ajax() で `/api/upload` に送信
- アップロード完了後に `#file-list-container` を更新

#### 4. フォームの移動
- 現在：ファイル一覧の下（line 145-197）
- 変更後：ファイル一覧の上（New Folderボタンの下、アコーディオン内）
- アップロードフォームは削除（ドラッグ＆ドロップに統合）

### 将来のテキスト作成機能対応
- 「New File」ボタンは今回 disabled または coming soon 表示
- 次のプランで `/api/create-text` エンドポイントとフォームを実装
  - 実装時は New File ボタンクリックでテキスト作成フォームをアコーディオン展開

## 技術的考慮事項

### アイコン表現
- **絵文字は使用せず、SVGアイコンで表現する**
- 既存の `DeleteIcon` と同様のスタイル（`stroke="currentColor"`）で統一
- 新規アイコン：`FileIcon.tsx`（New File用）、`FolderIcon.tsx`（New Folder用）
- 既存アイコン：`DeleteIcon.tsx`（削除ボタン用）

### htmxとの連携
- ドラッグアンドドロップはJavaScriptで処理し、FormDataを構築
- htmx.ajax() を使用して非同期アップロード
- アップロード完了後に `#file-list-container` を更新

### スタイル
- 既存のグラデーション・ボーダーデザインを維持
- ドラッグ中は `border-purple-500 bg-purple-50` などの視覚的フィードバック

## 検証手順
1. ファイル一覧が表示されることを確認
2. アクションボタン（New File, New Folder）がファイル一覧の上に表示されることを確認
3. New Fileボタンがdisabled状態であることを確認
4. New Folderボタンをクリックするとフォルダ作成フォームが展開されることを確認
5. もう一度 New Folder ボタンをクリックするとフォームが閉じることを確認
6. ファイル一覧エリアにファイルをドラッグすると、ドロップ可能である視覚的フィードバックが表示されることを確認
7. ドラッグ＆ドロップでファイルアップロードができることを確認
8. アップロード完了後、ファイル一覧が自動更新されることを確認
9. フォルダ作成が正常に動作することを確認
